# z_function

Z-функция

Z-функция для индекса i ищет максимальное число l, такое, что подстрока, начинающаяся в i и длиной l, равна префиксу длины l

Z-функция может быть использована для проверки вхождения подстроки в строку (нужно дописать к меньшей строке символ, которого нет в обоих строках, и большую строку)
тогда, посчитав z-функцию от получившейся строки можно будет найти все вхождения первой строки во вторую

Z-функция может быть реализована по-разному
Основные способы:
1. Хэши (описано в hashes)
2. Алгоритм, вычисляющий следующие значения, используя уже вычисленные значения

Рассмотрим второй алгоритм

Следующие значения вычисляются на основе предыдущих
Хранятся границы такого z-блока, правая граница которого максимальна
(z-блок - подстрока с началом в i и максимальной длиной l (значение z-функции для i))

Есть два случая:
1. i не лежит в сохранённом блоке (тогда нужно наивно пройти по строке и сравнить)
2. i лежит в сохранённом блоке (тогда есть два случая)
   2.1 z[i - left] + i > right (тогда нужно наивно пройти по строке от r и сравнить)
   2.2. z[i - left] + i <= right (тогда уже известно значение, оно равно z[i - left])

Реализация такого алгоритма (l, r на полуинтервалах):
```cpp
int n = s.size();
vector<int> z(n);
z[0] = n;
int l = 0, r = 1;
for (int i = 1; i < n; i++) {
    z[i] = max(0, min(z[i - l], r - i));
    while (z[i] + i < n && s[z[i]] == s[z[i] + i]) {
        z[i]++;
    }
    if (z[i] + i > r) {
        r = z[i] + i;
        l = i;
    }
}
```

Применения:
1. Поиск подстроки в строке
    Запишем две строки через спец. символ (сначала строка, которую мы ищем) и посчитаем z-функцию
    Позиция, где z-функция равна длине искомой строки - начало вхождения подстроки

1. Период строки (требуется найти минимальную по длине строку t такую, что строку s можно представить в виде конкатенации нескольких строк t)
    Посчитаем z-функцию
    Теперь пройдём по массиву z и найдём первую позицию i такую, что i + z[i] == n && n % i == 0 (1-индексация)
    Тогда ответ i
    Если такой позиции нет, ответ - n
